scp -r /home/user/mzq/workspaces/project/dear_pytorch/ATC24-FG-MGS/fgmgs_ours/*  user@node16:/home/user/mzq/workspaces/project/dear_pytorch/ATC24-FG-MGS/fgmgs_ours/
scp -r /home/user/mzq/workspaces/project/dear_pytorch/ATC24-FG-MGS/fgmgs_ours/*  user@node17:/home/user/mzq/workspaces/project/dear_pytorch/ATC24-FG-MGS/fgmgs_ours/
scp -r /home/user/mzq/workspaces/project/dear_pytorch/ATC24-FG-MGS/fgmgs_ours/*  user@node18:/home/user/mzq/workspaces/project/dear_pytorch/ATC24-FG-MGS/fgmgs_ours/
scp -r /home/user/mzq/workspaces/project/dear_pytorch/ATC24-FG-MGS/fgmgs_ours/*  user@node19:/home/user/mzq/workspaces/project/dear_pytorch/ATC24-FG-MGS/fgmgs_ours/
scp -r /home/user/mzq/workspaces/project/dear_pytorch/ATC24-FG-MGS/fgmgs_ours/*  user@node20:/home/user/mzq/workspaces/project/dear_pytorch/ATC24-FG-MGS/fgmgs_ours/
scp -r /home/user/mzq/workspaces/project/dear_pytorch/ATC24-FG-MGS/fgmgs_ours/*  user@node21:/home/user/mzq/workspaces/project/dear_pytorch/ATC24-FG-MGS/fgmgs_ours/
scp -r /home/user/mzq/workspaces/project/dear_pytorch/ATC24-FG-MGS/fgmgs_ours/*  user@node22:/home/user/mzq/workspaces/project/dear_pytorch/ATC24-FG-MGS/fgmgs_ours/


# HOROVOD_GPU_OPERATIONS=NCCL HOROVOD_CACHE_CAPACITY=0 bash run.sh
# dnn="${dnn:-resnet20}"
# source exp_configs/$dnn.conf
# nworkers="${nworkers:-4}"


# 23705252*4/1024 = 92598.640625

# 10000k
# density="${density:-0.1079929467}"

# 100k
# density="${density:-0.001079929467}"


density="${density:-0.1}"
threshold="${threshold:-8192}"
# compressor="${compressor:-topk}"
compressor="${compressor:-eftopk}"
max_epochs="${max_epochs:-80}"
nwpernode=4
nstepsupdate=1
PY=python


HOROVOD_GPU_OPERATIONS=NCCL HOROVOD_CACHE_CAPACITY=0 horovodrun -np 8 -H node15:1,node16:1,node17:1,node18:1,node19:1,node20:1,node21:1,node22:1   python  pytorch_cifar100_resnet50_time.py  --epochs $max_epochs --density $density --compressor $compressor --threshold $threshold

# 0.1k = [[0.0041179656982421875], [0.003919363021850586], [0.011768817901611328], [0.0038611888885498047], [0.004126787185668945], [0.00526738166809082], [0.004214763641357422], [0.01775050163269043], [0.006400346755981445], [0.006075620651245117], [0.006596088409423828], [0.012271404266357422], [0.0073049068450927734],
# 1k =  [[0.004702329635620117], [0.004426002502441406], [0.006860256195068359], [0.005398988723754883], [0.007683753967285156], [0.005567073822021484], [0.004902362823486328], [0.007025003433227539], [0.005201578140258789], [0.00822591781616211], [0.004152536392211914], [0.00533747673034668], [0.007905244827270508],
# 6.75k = 0.0015125274658203125
# 10k = [[0.011170387268066406], [0.007164716720581055], [0.00807642936706543], [0.005961894989013672], [0.006506919860839844], [0.018954992294311523], [0.010447263717651367], [0.006433725357055664], [0.006229877471923828], [0.018814802169799805], [0.011809587478637695], [0.006885051727294922], [0.0061185359954833984], [0.019100427627563477], [0.007082700729370117], [0.011896610260009766], [0.006299018859863281], [0.02025127410888672], [0.0072672367095947266], [0.011243581771850586]]
# 100k = [[0.011075973510742188], [0.006595134735107422], [0.006005764007568359], [0.0060272216796875], [0.008306741714477539], [0.0059719085693359375], [0.005752086639404297], [0.005872249603271484], [0.006841421127319336], [0.005892515182495117], [0.0056612491607666016], [0.005585193634033203],
# 1000k = [[0.030220985412597656], [0.017979145050048828], [0.018564462661743164], [0.02210688591003418], [0.02178168296813965], [0.02104783058166504], [0.020754575729370117], [0.019115209579467773], [0.016987323760986328], [0.01653265953063965], [0.015837907791137695], [0.01654195785522461],
# 10000k = [[0.12149715423583984], [0.11170434951782227], [0.10846257209777832], [0.1078341007232666], [0.10873079299926758], [0.1081998348236084], [0.10628390312194824], [0.10929727554321289], [0.11005139350891113], [0.11142444610595703], [0.1079549789428711], [0.10632872581481934], [0.10946798324584961], [0.10777044296264648], [0.10573005676269531], [0.1065835952758789], [0.11065030097961426], [0.10877799987792969], [0.10793519020080566],
# 100000k = [[0.967970609664917], [0.9556348323822021], [0.9529705047607422], [0.9546036720275879], [0.9522168636322021], [0.9476020336151123], [0.9498670101165771], [0.9507250785827637], [0.9492425918579102], [0.9513697624206543], [0.9463450908660889], [0.9504077434539795], [0.9500365257263184]

# 0.006860256195068359, 0.0065064716720581055, 0.0060272216796875, 0.018564462661743164, 0.1078341007232666, 1.015467643737793
